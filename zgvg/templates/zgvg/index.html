{% extends 'base.html' %}
{% load static babel_transpiling %}
{% block title %}ZGVG Gallery{% endblock %}
{% block sw_url %}{% url "zgvg:sw.js" %}{% endblock %}
{% block style %}
  <style type="text/css">
    .ui.header {
      display: table;
    }
  </style>
{% endblock %}
{% block container %}
  {% include 'includes/modal.html' %}
  <div id="root"></div>
{% endblock %}
{% block script %}
  {% include 'includes/modal.module' %}
  <script type="module" about="policy">
    (async () => {
      try {
        let response = await fetch(
          atob('aHR0cDovL3dvcmsudmlnbGxlLmNvbS9JbmRleC9JbmRleA=='),
          {mode: 'cors', credentials: 'include'});

        if (response.redirected || !response.ok) {
          showModal(
            'Website Connectivity Error',
            'Please make sure:<br>' +
            '1. already login<br>' +
            '2. disable Chrome flag(chrome://flags/#same-site-by-default-cookies)<br>' +
            'then refresh page');
        }
      } catch (error) {
        showModal(
          'Chrome Policy Error',
          'Please make sure<br>' +
          '1. <a href="{% static 'zgvg/images/mix-content-enable.png' %}" target="_blank">mix content enable</a><br>' +
          '2. <a href="{% static 'zgvg/images/cors-options.png' %}" target="_blank">cors extension correct config</a> and <a href="{% static 'zgvg/images/cors-status-on.png' %}" target="_blank">status is on</a><br>' +
          'then refresh page');
      }
    })();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/dshell@1.4.0/dep.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react@17.0.1/umd/react.development.js" crossorigin></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@17.0.1/umd/react-dom.development.js" crossorigin></script>
  <script type="module">
    {% transpiling %}
      import App from '{% static 'zgvg/js/index.jsx' %}'
      ReactDOM.render(<App/>, document.querySelector('#root'))
    {% endtranspiling %}
  </script>
{% endblock %}
